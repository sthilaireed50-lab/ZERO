-- üçé AUTO QUEST SYSTEM - BLOX FRUITS
-- Sistema autom√°tico de misiones basado en datos del juego

local Players = game:GetService("Players")
local Workspace = game:GetService("Workspace")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local RunService = game:GetService("RunService")
local TweenService = game:GetService("TweenService")
local VirtualInput = game:GetService("VirtualInputManager")

-- Variables principales
local Player = Players.LocalPlayer
local Character = Player.Character or Player.CharacterAdded:Wait()
local HumanoidRootPart = Character:WaitForChild("HumanoidRootPart")
local Humanoid = Character:WaitForChild("Humanoid")

-- Sistema de datos de quests (los que proporcionaste)
local QuestData = {
    Data = {
        LastClosestNPC = "",
        IsFakeData = true,
        NPCs = {
            ["BuggyQuest1"] = "Pirate Adventurer",
            ["FountainQuest"] = "Freezeburg Quest Giver",
            ["ColosseumQuest"] = "Colosseum Quest Giver",
            ["SkyQuest"] = "Sky Adventurer",
            ["JungleQuest"] = "Adventurer",
            ["MagmaQuest"] = "The Mayor",
            ["PrisonerQuest"] = "Jail Keeper",
            ["SkyExp2Quest"] = "Sky Quest Giver 2",
            ["MarineQuest2"] = "Marine",
            ["BanditQuest1"] = "Bandit Quest Giver",
            ["FishmanQuest"] = "King Neptune",
            ["MarineQuest"] = "Marine Leader",
            ["SkyExp1Quest"] = "Mole",
            ["DesertQuest"] = "Desert Adventurer",
            ["ImpelQuest"] = "Head Jailer",
            ["SnowQuest"] = "Villager",
            ["IceSideQuest"] = "Ice Quest Giver",
            ["ZombieQuest"] = "Graveyard Quest Giver",
            ["Area2Quest"] = "Area 2 Quest Giver",
            ["Area1Quest"] = "Area 1 Quest Giver",
            ["MarineQuest3"] = "Marine Quest Giver",
            ["SnowMountainQuest"] = "Snow Quest Giver",
            ["ShipQuest1"] = "Rear Crew Quest Giver",
            ["FireSideQuest"] = "Fire Quest Giver",
            ["ShipQuest2"] = "Front Crew Quest Giver",
            ["ForgottenQuest"] = "Forgotten Quest Giver",
            ["FrostQuest"] = "Frost Quest Giver",
            ["IceCreamIslandQuest"] = "Ice Cream Quest Giver",
            ["VenomCrewQuest"] = "Hydra Town Quest Giver",
            ["ChocQuest1"] = "Chocolate Quest Giver 1",
            ["DeepForestIsland"] = "Deep Forest Quest Giver",
            ["DragonCrewQuest"] = "Dragon Crew Quest Giver",
            ["DeepForestIsland2"] = "Deep Forest Area 2 Quest Giver",
            ["NutsIslandQuest"] = "Peanut Quest Giver",
            ["HornedMan"] = "Horned Man",
            ["PiratePortQuest"] = "Pirate Port Quest Giver",
            ["CandyQuest1"] = "Candy Cane Quest Giver",
            ["MarineTreeIsland"] = "Marine Tree Quest Giver",
            ["HauntedQuest2"] = "Haunted Castle Quest Giver 2",
            ["TikiQuest2"] = "Tiki Quest Giver 2",
            ["TikiQuest1"] = "Tiki Quest Giver 1",
            ["DeepForestIsland3"] = "Turtle Adventure Quest Giver",
            ["CakeQuest2"] = "Cake Quest Giver 2",
            ["ArenaTrainer"] = "Arena Trainer",
            ["TikiQuest3"] = "Tiki Quest Giver 3",
            ["CakeQuest1"] = "Cake Quest Giver 1",
            ["ChocQuest2"] = "Chocolate Quest Giver 2",
            ["HauntedQuest1"] = "Haunted Castle Quest Giver 1"
        }
    }
}

-- Configuraci√≥n del sistema de quests
local QuestSystem = {
    Enabled = false,
    CurrentQuest = nil,
    CurrentNPC = nil,
    CurrentTask = nil,
    Kills = 0,
    RequiredKills = 0,
    TargetNPC = nil,
    
    -- Configuraci√≥n
    AutoAccept = true,
    AutoTurnIn = true,
    FarmDistance = 30,
    WalkSpeed = 50,
    JumpPower = 50,
    
    -- Estado
    IsFarming = false,
    HasQuest = false,
    QuestCompleted = false
}

-- Funci√≥n para encontrar NPC por nombre
local function FindNPC(npcName)
    for _, npc in pairs(Workspace.NPCs:GetChildren()) do
        if npc.Name == npcName then
            if npc:FindFirstChild("HumanoidRootPart") then
                return npc
            end
        end
    end
    return nil
end

-- Funci√≥n para obtener quest basado en nivel
local function GetQuestForLevel(playerLevel)
    -- Orden de quests por nivel
    local questOrder = {
        {level = 0, quest = "BanditQuest1"},
        {level = 10, quest = "JungleQuest"},
        {level = 30, quest = "BuggyQuest1"},
        {level = 60, quest = "DesertQuest"},
        {level = 90, quest = "SnowQuest"},
        {level = 120, quest = "MarineQuest2"},
        {level = 150, quest = "SkyQuest"},
        {level = 190, quest = "PrisonerQuest"},
        {level = 220, quest = "ImpelQuest"},
        {level = 250, quest = "ColosseumQuest"},
        {level = 300, quest = "MagmaQuest"},
        {level = 375, quest = "FishmanQuest"},
        {level = 450, quest = "SkyExp1Quest"},
        {level = 525, quest = "SkyExp2Quest"},
        {level = 625, quest = "FountainQuest"},
        {level = 700, quest = "Area1Quest"},
        {level = 775, quest = "Area2Quest"},
        {level = 875, quest = "MarineQuest3"},
        {level = 950, quest = "ZombieQuest"},
        {level = 1000, quest = "SnowMountainQuest"},
        {level = 1100, quest = "IceSideQuest"},
        {level = 1175, quest = "FireSideQuest"},
        {level = 1250, quest = "ShipQuest1"},
        {level = 1300, quest = "ShipQuest2"},
        {level = 1350, quest = "FrostQuest"},
        {level = 1425, quest = "ForgottenQuest"},
        {level = 1500, quest = "PiratePortQuest"},
        {level = 1575, quest = "DragonCrewQuest"},
        {level = 1625, quest = "VenomCrewQuest"},
        {level = 1700, quest = "MarineTreeIsland"},
        {level = 1775, quest = "DeepForestIsland3"},
        {level = 1825, quest = "DeepForestIsland"},
        {level = 1900, quest = "DeepForestIsland2"},
        {level = 1975, quest = "HauntedQuest1"},
        {level = 2025, quest = "HauntedQuest2"},
        {level = 2075, quest = "NutsIslandQuest"},
        {level = 2125, quest = "IceCreamIslandQuest"},
        {level = 2200, quest = "CakeQuest1"},
        {level = 2250, quest = "CakeQuest2"},
        {level = 2300, quest = "ChocQuest1"},
        {level = 2350, quest = "ChocQuest2"},
        {level = 2400, quest = "CandyQuest1"},
        {level = 2450, quest = "TikiQuest1"},
        {level = 2500, quest = "TikiQuest2"},
        {level = 2550, quest = "TikiQuest3"}
    }
    
    -- Buscar quest apropiada para el nivel
    for i = #questOrder, 1, -1 do
        if playerLevel >= questOrder[i].level then
            return questOrder[i].quest
        end
    end
    
    return "BanditQuest1"
end

-- Funci√≥n para obtener informaci√≥n de la quest
local function GetQuestInfo(questKey)
    -- Aqu√≠ deber√≠as tener la estructura completa de quests
    -- Por ahora devolvemos datos de ejemplo
    local questInfo = {
        LevelReq = 0,
        Name = "Bandit",
        Task = {["Bandit"] = 5}
    }
    
    -- Basado en las quests que proporcionaste
    if questKey == "BanditQuest1" then
        questInfo = {LevelReq = 0, Name = "Bandits", Task = {Bandit = 5}}
    elseif questKey == "JungleQuest" then
        questInfo = {LevelReq = 10, Name = "Monkeys", Task = {Monkey = 6}}
    elseif questKey == "BuggyQuest1" then
        questInfo = {LevelReq = 30, Name = "Pirates", Task = {Pirate = 8}}
    elseif questKey == "DesertQuest" then
        questInfo = {LevelReq = 60, Name = "Desert Bandit", Task = {["Desert Bandit"] = 8}}
    elseif questKey == "SnowQuest" then
        questInfo = {LevelReq = 90, Name = "Snow Bandit", Task = {["Snow Bandit"] = 7}}
    end
    
    return questInfo
end

-- Funci√≥n para teleport a NPC
local function TeleportToNPC(npc)
    if not npc or not npc:FindFirstChild("HumanoidRootPart") then return end
    
    local npcPos = npc.HumanoidRootPart.Position
    local teleportPos = npcPos + Vector3.new(0, 3, -5)
    
    HumanoidRootPart.CFrame = CFrame.new(teleportPos)
    
    -- Mirar al NPC
    HumanoidRootPart.CFrame = CFrame.new(
        teleportPos,
        Vector3.new(npcPos.X, teleportPos.Y, npcPos.Z)
    )
    
    return true
end

-- Funci√≥n para interactuar con NPC (simular click)
local function InteractWithNPC(npc)
    if not npc then return false end
    
    -- Simular click en el NPC
    local clickPos = npc.HumanoidRootPart.Position
    local ray = Ray.new(clickPos, Vector3.new(0, -10, 0))
    
    -- Esperar un momento
    task.wait(0.5)
    
    return true
end

-- Funci√≥n para encontrar enemigos de la quest
local function FindQuestEnemies(enemyName)
    local enemies = {}
    
    -- Buscar en Enemies
    for _, enemy in pairs(Workspace.Enemies:GetChildren()) do
        if enemy.Name:find(enemyName) or enemy.Name == enemyName then
            if enemy:FindFirstChild("Humanoid") and enemy.Humanoid.Health > 0 then
                if enemy:FindFirstChild("HumanoidRootPart") then
                    table.insert(enemies, enemy)
                end
            end
        end
    end
    
    -- Buscar en NPCs (algunos enemigos est√°n ah√≠)
    for _, npc in pairs(Workspace.NPCs:GetChildren()) do
        if npc.Name:find(enemyName) or npc.Name == enemyName then
            if npc:FindFirstChild("Humanoid") and npc.Humanoid.Health > 0 then
                if npc:FindFirstChild("HumanoidRootPart") then
                    table.insert(enemies, npc)
                end
            end
        end
    end
    
    return enemies
end

-- Funci√≥n para farmear enemigos
local function FarmEnemies(enemyName, requiredKills)
    local kills = 0
    local maxAttempts = requiredKills * 3
    
    for attempt = 1, maxAttempts do
        if kills >= requiredKills then break end
        
        -- Buscar enemigos
        local enemies = FindQuestEnemies(enemyName)
        
        if #enemies > 0 then
            -- Tomar el enemigo m√°s cercano
            local closestEnemy = nil
            local closestDistance = math.huge
            
            for _, enemy in ipairs(enemies) do
                local distance = (HumanoidRootPart.Position - enemy.HumanoidRootPart.Position).Magnitude
                if distance < closestDistance then
                    closestDistance = distance
                    closestEnemy = enemy
                end
            end
            
            if closestEnemy then
                -- Teleport al enemigo
                local enemyPos = closestEnemy.HumanoidRootPart.Position
                local attackPos = enemyPos + Vector3.new(0, 5, -8)
                HumanoidRootPart.CFrame = CFrame.new(attackPos)
                
                -- Atacar
                VirtualInput:SendMouseButtonEvent(0, 0, 0, true, game, 0)
                task.wait(0.1)
                VirtualInput:SendMouseButtonEvent(0, 0, 0, false, game, 0)
                
                -- Usar habilidades
                VirtualInput:SendKeyEvent(true, "Z", false, game)
                task.wait(0.1)
                VirtualInput:SendKeyEvent(false, "Z", false, game)
                
                -- Verificar si muri√≥
                task.wait(0.5)
                if not closestEnemy.Parent or closestEnemy.Humanoid.Health <= 0 then
                    kills = kills + 1
                    QuestSystem.Kills = kills
                    print("[QUEST] Eliminados: " .. kills .. "/" .. requiredKills)
                end
            end
        else
            -- Buscar en otras ubicaciones
            print("[QUEST] Buscando " .. enemyName .. "...")
            task.wait(1)
        end
        
        task.wait(0.3)
    end
    
    return kills
end

-- Sistema principal de Auto Quest
local QuestThread
local function StartQuestSystem()
    if QuestThread then
        task.cancel(QuestThread)
    end
    
    QuestThread = task.spawn(function()
        while QuestSystem.Enabled do
            task.wait(1)
            
            -- Obtener nivel del jugador (simulado)
            local playerLevel = 1  -- Esto deber√≠a ser real
            
            -- Obtener quest actual basada en nivel
            local questKey = GetQuestForLevel(playerLevel)
            local questInfo = GetQuestInfo(questKey)
            local npcName = QuestData.Data.NPCs[questKey]
            
            print("[QUEST SYSTEM]")
            print("Quest: " .. questKey)
            print("NPC: " .. (npcName or "Desconocido"))
            print("Tarea: " .. questInfo.Name)
            
            -- Buscar NPC de la quest
            local npc = FindNPC(npcName)
            
            if npc then
                -- Teleport al NPC
                if TeleportToNPC(npc) then
                    print("[QUEST] Teleport a NPC: " .. npcName)
                    
                    -- Interactuar con NPC (aceptar quest)
                    if QuestSystem.AutoAccept then
                        InteractWithNPC(npc)
                        print("[QUEST] Quest aceptada")
                        task.wait(1)
                        
                        -- Obtener enemigo a farmear
                        local enemyName = next(questInfo.Task)
                        local requiredKills = questInfo.Task[enemyName]
                        
                        if enemyName and requiredKills then
                            print("[QUEST] Objetivo: " .. enemyName .. " x" .. requiredKills)
                            
                            -- Farmear enemigos
                            QuestSystem.Kills = 0
                            local kills = FarmEnemies(enemyName, requiredKills)
                            
                            if kills >= requiredKills then
                                print("[QUEST] ‚úÖ Quest completada!")
                                
                                -- Volver al NPC para entregar
                                if QuestSystem.AutoTurnIn then
                                    TeleportToNPC(npc)
                                    task.wait(1)
                                    InteractWithNPC(npc)
                                    print("[QUEST] Quest entregada")
                                end
                            end
                        end
                    end
                end
            else
                print("[QUEST] ‚ùå NPC no encontrado: " .. (npcName or "Desconocido"))
            end
            
            task.wait(3)
        end
    end)
end

-- ============================================
-- INTERFAZ GR√ÅFICA DEL SISTEMA DE QUESTS
-- ============================================

local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "QuestSystemGUI"
ScreenGui.Parent = game:GetService("CoreGui")

local MainFrame = Instance.new("Frame")
MainFrame.Size = UDim2.new(0, 350, 0, 400)
MainFrame.Position = UDim2.new(0, 20, 0.5, -200)
MainFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
MainFrame.BorderSizePixel = 0
MainFrame.Parent = ScreenGui

local Corner = Instance.new("UICorner")
Corner.CornerRadius = UDim.new(0, 10)
Corner.Parent = MainFrame

-- T√≠tulo
local Title = Instance.new("TextLabel")
Title.Size = UDim2.new(1, 0, 0, 50)
Title.BackgroundColor3 = Color3.fromRGB(0, 100, 200)
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.Text = "üçé AUTO QUEST SYSTEM"
Title.Font = Enum.Font.GothamBold
Title.TextSize = 18
Title.Parent = MainFrame

local TitleCorner = Instance.new("UICorner")
TitleCorner.CornerRadius = UDim.new(0, 10)
TitleCorner.Parent = Title

-- Bot√≥n principal
local ToggleButton = Instance.new("TextButton")
ToggleButton.Size = UDim2.new(0.9, 0, 0, 45)
ToggleButton.Position = UDim2.new(0.05, 0, 0, 70)
ToggleButton.BackgroundColor3 = Color3.fromRGB(255, 50, 50)
ToggleButton.TextColor3 = Color3.fromRGB(255, 255, 255)
ToggleButton.Text = "‚ñ∂Ô∏è INICIAR AUTO QUEST"
ToggleButton.Font = Enum.Font.GothamBold
ToggleButton.TextSize = 16
ToggleButton.Parent = MainFrame

local ButtonCorner = Instance.new("UICorner")
ButtonCorner.CornerRadius = UDim.new(0, 8)
ButtonCorner.Parent = ToggleButton

-- Panel de informaci√≥n
local InfoFrame = Instance.new("Frame")
InfoFrame.Size = UDim2.new(0.9, 0, 0, 200)
InfoFrame.Position = UDim2.new(0.05, 0, 0, 130)
InfoFrame.BackgroundColor3 = Color3.fromRGB(35, 35, 45)
InfoFrame.Parent = MainFrame

local InfoCorner = Instance.new("UICorner")
InfoCorner.CornerRadius = UDim.new(0, 8)
InfoCorner.Parent = InfoFrame

-- Labels de informaci√≥n
local QuestLabel = Instance.new("TextLabel")
QuestLabel.Size = UDim2.new(1, -20, 0, 30)
QuestLabel.Position = UDim2.new(0, 10, 0, 10)
QuestLabel.BackgroundTransparency = 1
QuestLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
QuestLabel.Text = "Quest Actual: Ninguna"
QuestLabel.Font = Enum.Font.Gotham
QuestLabel.TextSize = 14
QuestLabel.TextXAlignment = Enum.TextXAlignment.Left
QuestLabel.Parent = InfoFrame

local NPCLabel = Instance.new("TextLabel")
NPCLabel.Size = UDim2.new(1, -20, 0, 30)
NPCLabel.Position = UDim2.new(0, 10, 0, 50)
NPCLabel.BackgroundTransparency = 1
NPCLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
NPCLabel.Text = "NPC: ---"
NPCLabel.Font = Enum.Font.Gotham
NPCLabel.TextSize = 14
NPCLabel.TextXAlignment = Enum.TextXAlignment.Left
NPCLabel.Parent = InfoFrame

local TaskLabel = Instance.new("TextLabel")
TaskLabel.Size = UDim2.new(1, -20, 0, 30)
TaskLabel.Position = UDim2.new(0, 10, 0, 90)
TaskLabel.BackgroundTransparency = 1
TaskLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
TaskLabel.Text = "Tarea: ---"
TaskLabel.Font = Enum.Font.Gotham
TaskLabel.TextSize = 14
TaskLabel.TextXAlignment = Enum.TextXAlignment.Left
TaskLabel.Parent = InfoFrame

local ProgressLabel = Instance.new("TextLabel")
ProgressLabel.Size = UDim2.new(1, -20, 0, 30)
ProgressLabel.Position = UDim2.new(0, 10, 0, 130)
ProgressLabel.BackgroundTransparency = 1
ProgressLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
ProgressLabel.Text = "Progreso: 0/0"
ProgressLabel.Font = Enum.Font.Gotham
ProgressLabel.TextSize = 14
ProgressLabel.TextXAlignment = Enum.TextXAlignment.Left
ProgressLabel.Parent = InfoFrame

-- Barra de progreso
local ProgressBar = Instance.new("Frame")
ProgressBar.Size = UDim2.new(1, -20, 0, 10)
ProgressBar.Position = UDim2.new(0, 10, 0, 165)
ProgressBar.BackgroundColor3 = Color3.fromRGB(50, 50, 70)
ProgressBar.Parent = InfoFrame

local ProgressFill = Instance.new("Frame")
ProgressFill.Size = UDim2.new(0, 0, 1, 0)
ProgressFill.BackgroundColor3 = Color3.fromRGB(0, 200, 100)
ProgressFill.Parent = ProgressBar

local ProgressCorner = Instance.new("UICorner")
ProgressCorner.CornerRadius = UDim.new(1, 0)
ProgressCorner.Parent = ProgressBar

local ProgressFillCorner = Instance.new("UICorner")
ProgressFillCorner.CornerRadius = UDim.new(1, 0)
ProgressFillCorner.Parent = ProgressFill

-- Bot√≥n de cerrar
local CloseButton = Instance.new("TextButton")
CloseButton.Size = UDim2.new(0, 30, 0, 30)
CloseButton.Position = UDim2.new(1, -35, 0, 10)
CloseButton.BackgroundColor3 = Color3.fromRGB(255, 50, 50)
CloseButton.TextColor3 = Color3.fromRGB(255, 255, 255)
CloseButton.Text = "X"
CloseButton.Font = Enum.Font.GothamBold
CloseButton.TextSize = 14
CloseButton.Parent = MainFrame

-- Configurar controles
ToggleButton.MouseButton1Click:Connect(function()
    QuestSystem.Enabled = not QuestSystem.Enabled
    
    if QuestSystem.Enabled then
        ToggleButton.BackgroundColor3 = Color3.fromRGB(50, 200, 50)
        ToggleButton.Text = "‚è∏Ô∏è DETENER AUTO QUEST"
        
        -- Iniciar sistema
        StartQuestSystem()
        
        print("========================================")
        print("üçé AUTO QUEST SYSTEM ACTIVADO")
        print("========================================")
    else
        ToggleButton.BackgroundColor3 = Color3.fromRGB(255, 50, 50)
        ToggleButton.Text = "‚ñ∂Ô∏è INICIAR AUTO QUEST"
        
        -- Detener sistema
        if QuestThread then
            task.cancel(QuestThread)
        end
        
        print("üçé AUTO QUEST SYSTEM DETENIDO")
    end
end)

CloseButton.MouseButton1Click:Connect(function()
    ScreenGui:Destroy()
end)

-- Hotkey para abrir/cerrar
local UserInputService = game:GetService("UserInputService")
UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if input.KeyCode == Enum.KeyCode.P then
        MainFrame.Visible = not MainFrame.Visible
    end
end)

print("========================================")
print("üçé AUTO QUEST SYSTEM CARGADO")
print("üéÆ Controles:")
print("‚Ä¢ Bot√≥n: Activar/Desactivar")
print("‚Ä¢ Tecla P: Mostrar/Ocultar men√∫")
print("========================================")
