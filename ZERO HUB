-- Script para Delta Executor - Auto Farm Musone (Sea Beast)
-- Guarda como: AUTO_MUSONE.lua

-- Servicios
local Players = game:GetService("Players")
local Workspace = game:GetService("Workspace")
local TweenService = game:GetService("TweenService")
local VirtualInput = game:GetService("VirtualInputManager")
local RunService = game:GetService("RunService")

-- Variables
local Player = Players.LocalPlayer
local Character = Player.Character or Player:WaitForChild("CharacterAdded"):Wait()
local HumanoidRootPart = Character:WaitForChild("HumanoidRootPart")
local Humanoid = Character:WaitForChild("Humanoid")

-- Configuraci√≥n espec√≠fica para Musone
local Config = {
    AutoFarmMusone = true,
    AutoDodge = true,
    UseSkills = true,
    WalkSpeed = 60,
    JumpPower = 80,
    AttackDistance = 30,
    SafeDistance = 25,
    UseRaceV2 = false,
    SelectedFruit = nil
}

-- Identificar fruta equipada
local function GetEquippedFruit()
    for _, tool in ipairs(Player.Backpack:GetChildren()) do
        if tool:IsA("Tool") and tool:FindFirstChild("Fruit") then
            return tool.Name
        end
    end
    return "None"
end

Config.SelectedFruit = GetEquippedFruit()

-- Funci√≥n de teleport optimizada
local function TweenToMusone(position, instant)
    if not HumanoidRootPart or not HumanoidRootPart.Parent then
        return
    end
    
    local distance = (HumanoidRootPart.Position - position).Magnitude
    
    if instant then
        HumanoidRootPart.CFrame = CFrame.new(position) + Vector3.new(0, 5, 0)
        return
    end
    
    local tweenInfo = TweenInfo.new(
        distance / Config.WalkSpeed,
        Enum.EasingStyle.Linear
    )
    
    local goal = {
        CFrame = CFrame.new(position + Vector3.new(0, 5, 0))
    }
    
    local tween = TweenService:Create(HumanoidRootPart, tweenInfo, goal)
    tween:Play()
    
    local startTime = tick()
    while tick() - startTime < 5 and tween.PlaybackState == Enum.PlaybackState.Playing do
        RunService.Heartbeat:Wait()
    end
    tween:Cancel()
end

-- Esquivar ataques de Musone
local function DodgeMusoneAttack(musone)
    if not Config.AutoDodge or not musone then return end
    
    local attackAnim = musone:FindFirstChild("Attack")
    if attackAnim and attackAnim.IsPlaying then
        -- Retroceder r√°pidamente
        local backwardDir = (HumanoidRootPart.Position - musone.HumanoidRootPart.Position).Unit
        local dodgePos = HumanoidRootPart.Position + (backwardDir * 30)
        TweenToMusone(dodgePos, true)
        task.wait(0.5)
    end
end

-- Ataque optimizado para Musone
local function AttackMusone()
    if not Config.UseSkills then return end
    
    -- Usar habilidad Z (primaria)
    VirtualInput:SendKeyEvent(true, "Z", false, game)
    task.wait(0.1)
    VirtualInput:SendKeyEvent(false, "Z", false, game)
    
    -- Usar habilidad X (secundaria)
    task.wait(0.3)
    VirtualInput:SendKeyEvent(true, "X", false, game)
    task.wait(0.1)
    VirtualInput:SendKeyEvent(false, "X", false, game)
    
    -- Usar habilidad C (terciaria si existe)
    task.wait(0.3)
    VirtualInput:SendKeyEvent(true, "C", false, game)
    task.wait(0.1)
    VirtualInput:SendKeyEvent(false, "C", false, game)
    
    -- Usar habilidad V (especial si existe)
    task.wait(0.3)
    VirtualInput:SendKeyEvent(true, "V", false, game)
    task.wait(0.1)
    VirtualInput:SendKeyEvent(false, "V", false, game)
    
    -- Ataque b√°sico (click)
    VirtualInput:SendMouseButtonEvent(0, 0, 0, true, game, 0)
    task.wait(0.05)
    VirtualInput:SendMouseButtonEvent(0, 0, 0, false, game, 0)
end

-- Buscar Musone espec√≠ficamente
local function FindMusone()
    local musones = {}
    
    -- Buscar en Enemies
    for _, enemy in pairs(Workspace.Enemies:GetChildren()) do
        if enemy.Name:lower():find("sea") or enemy.Name:lower():find("beast") or enemy.Name:lower():find("musone") then
            if enemy:FindFirstChild("Humanoid") and enemy.Humanoid.Health > 0 then
                if enemy:FindFirstChild("HumanoidRootPart") then
                    table.insert(musones, enemy)
                end
            end
        end
    end
    
    -- Buscar en Workspace directamente
    for _, obj in pairs(Workspace:GetChildren()) do
        if obj.Name:lower():find("sea") or obj.Name:lower():find("beast") or obj.Name:lower():find("musone") then
            if obj:FindFirstChild("Humanoid") and obj.Humanoid.Health > 0 then
                if obj:FindFirstChild("HumanoidRootPart") then
                    table.insert(musones, obj)
                end
            end
        end
    end
    
    -- Ordenar por distancia
    table.sort(musones, function(a, b)
        local distA = (HumanoidRootPart.Position - a.HumanoidRootPart.Position).Magnitude
        local distB = (HumanoidRootPart.Position - b.HumanoidRootPart.Position).Magnitude
        return distA < distB
    end)
    
    return musones[1] -- Devolver el m√°s cercano
end

-- Sistema principal de farm de Musone
if Config.AutoFarmMusone then
    task.spawn(function()
        while task.wait(0.5) and Config.AutoFarmMusone do
            pcall(function()
                if not Character or not HumanoidRootPart or Humanoid.Health <= 0 then
                    return
                end
                
                -- Buscar Musone
                local musone = FindMusone()
                
                if musone and musone:FindFirstChild("HumanoidRootPart") then
                    local musonePos = musone.HumanoidRootPart.Position
                    local distance = (HumanoidRootPart.Position - musonePos).Magnitude
                    
                    -- Esquivar si est√° muy cerca
                    if distance < 15 then
                        DodgeMusoneAttack(musone)
                    end
                    
                    -- Mantener distancia √≥ptima
                    local targetPos
                    if distance > Config.AttackDistance then
                        -- Acercarse
                        targetPos = musonePos + (musone.HumanoidRootPart.CFrame.LookVector * -Config.SafeDistance)
                    elseif distance < 10 then
                        -- Alejarse un poco
                        targetPos = HumanoidRootPart.Position + ((HumanoidRootPart.Position - musonePos).Unit * 20)
                    else
                        -- Mantener posici√≥n actual
                        targetPos = musonePos + Vector3.new(
                            math.random(-5, 5),
                            5,
                            math.random(-5, 5)
                        )
                    end
                    
                    -- Moverse a posici√≥n
                    TweenToMusone(targetPos)
                    
                    -- Mirar hacia Musone
                    HumanoidRootPart.CFrame = CFrame.new(
                        HumanoidRootPart.Position,
                        Vector3.new(musonePos.X, HumanoidRootPart.Position.Y, musonePos.Z)
                    )
                    
                    -- Atacar
                    AttackMusone()
                    
                    -- Mostrar info en consola
                    print("[MUSONE FARM] Vida restante: " .. math.floor(musone.Humanoid.Health))
                    
                else
                    -- Buscar nuevo Musone
                    print("[MUSONE FARM] Buscando Musone...")
                    -- Teleport a zonas comunes de Musone
                    local spawnPoints = {
                        Vector3.new(-2000, 100, 500),
                        Vector3.new(1500, 80, -2000),
                        Vector3.new(0, 50, -3000)
                    }
                    
                    for _, point in ipairs(spawnPoints) do
                        TweenToMusone(point)
                        task.wait(1)
                        if FindMusone() then break end
                    end
                end
            end)
        end
    end)
end

-- Configurar stats
Humanoid.WalkSpeed = Config.WalkSpeed
Humanoid.JumpPower = Config.JumpPower

-- Auto heal si tienes fruta Buddha
if Config.SelectedFruit:lower():find("buddha") then
    task.spawn(function()
        while task.wait(5) do
            if Humanoid.Health < Humanoid.MaxHealth * 0.5 then
                -- Transformaci√≥n Buddha para heal
                VirtualInput:SendKeyEvent(true, "F", false, game)
                task.wait(0.2)
                VirtualInput:SendKeyEvent(false, "F", false, game)
            end
        end
    end)
end

-- Anti AFK
local VirtualUser = game:GetService("VirtualUser")
Player.Idled:Connect(function()
    VirtualUser:CaptureController()
    VirtualUser:ClickButton2(Vector2.new(0, 0))
end)

-- Interfaz gr√°fica
local OrionLib = loadstring(game:HttpGet('https://pastebin.com/raw/2nwqjWkH'))()

local Window = OrionLib:MakeWindow({
    Name = "AUTO MUSONE - Delta Executor",
    HidePremium = false,
    SaveConfig = true,
    ConfigFolder = "MusoneFarmConfig"
})

-- Tab Musone
local MusoneTab = Window:MakeTab({
    Name = "Musone Farm",
    Icon = "rbxassetid://7072706620",
    PremiumOnly = false
})

MusoneTab:AddToggle({
    Name = "ü¶à Activar Auto Farm Musone",
    Default = Config.AutoFarmMusone,
    Callback = function(Value)
        Config.AutoFarmMusone = Value
        if Value then
            OrionLib:MakeNotification({
                Name = "Musone Farm",
                Content = "Auto Farm Musone ACTIVADO",
                Time = 5
            })
        end
    end
})

MusoneTab:AddToggle({
    Name = "üõ°Ô∏è Auto Esquivar",
    Default = Config.AutoDodge,
    Callback = function(Value)
        Config.AutoDodge = Value
    end
})

MusoneTab:AddToggle({
    Name = "‚ö° Usar Habilidades",
    Default = Config.UseSkills,
    Callback = function(Value)
        Config.UseSkills = Value
    end
})

MusoneTab:AddSlider({
    Name = "üìè Distancia de Ataque",
    Min = 10,
    Max = 50,
    Default = Config.AttackDistance,
    Color = Color3.fromRGB(0, 170, 255),
    Increment = 1,
    ValueName = "unidades",
    Callback = function(Value)
        Config.AttackDistance = Value
    end
})

-- Tab Player
local PlayerTab = Window:MakeTab({
    Name = "Player",
    Icon = "rbxassetid://7072725349",
    PremiumOnly = false
})

PlayerTab:AddSlider({
    Name = "üèÉ‚Äç‚ôÇÔ∏è Velocidad",
    Min = 16,
    Max = 200,
    Default = Config.WalkSpeed,
    Color = Color3.fromRGB(255, 100, 100),
    Increment = 1,
    ValueName = "vel",
    Callback = function(Value)
        Config.WalkSpeed = Value
        Humanoid.WalkSpeed = Value
    end
})

PlayerTab:AddSlider({
    Name = "ü¶ò Fuerza de Salto",
    Min = 50,
    Max = 200,
    Default = Config.JumpPower,
    Color = Color3.fromRGB(100, 255, 100),
    Increment = 1,
    ValueName = "jump",
    Callback = function(Value)
        Config.JumpPower = Value
        Humanoid.JumpPower = Value
    end
})

-- Tab Teleports
local TeleportTab = Window:MakeTab({
    Name = "Teleports",
    Icon = "rbxassetid://7072716643",
    PremiumOnly = false
})

local MusoneSpawns = {
    ["Spawn 1 (Ice)"] = Vector3.new(-2000, 100, 500),
    ["Spawn 2 (Jungle)"] = Vector3.new(1500, 80, -2000),
    ["Spawn 3 (Pirate)"] = Vector3.new(0, 50, -3000),
    ["Spawn 4 (Desert)"] = Vector3.new(1000, 60, 2000)
}

for name, position in pairs(MusoneSpawns) do
    TeleportTab:AddButton({
        Name = "üìç " .. name,
        Callback = function()
            TweenToMusone(position, true)
            OrionLib:MakeNotification({
                Name = "Teleport",
                Content = "Teleport a " .. name,
                Time = 3
            })
        end
    })
end

-- Tab Info
local InfoTab = Window:MakeTab({
    Name = "Info",
    Icon = "rbxassetid://7072708273",
    PremiumOnly = false
})

InfoTab:AddLabel("Frutas recomendadas para Musone:")
InfoTab:AddLabel("üî∏ Buddha - Mejor para farm")
InfoTab:AddLabel("üî∏ Dough - Da√±o alto")
InfoTab:AddLabel("üî∏ Dragon - Buena movilidad")
InfoTab:AddLabel("üî∏ Leopard - Ataques r√°pidos")

InfoTab:AddLabel("")
InfoTab:AddLabel("Recompensas por matar Musone:")
InfoTab:AddLabel("üí∞ $15,000 - $25,000")
InfoTab:AddLabel("‚≠ê 15,000 - 25,000 XP")
InfoTab:AddLabel("üéí Posibilidad de Frutas raras")

-- Inicializar
OrionLib:Init()

print("==================================")
print("AUTO MUSONE ACTIVADO")
print("Frutas equipada: " .. Config.SelectedFruit)
print("Recomendado: Buddha Fruit")
print("==================================")
