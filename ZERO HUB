-- Sistema básico de frutas del diablo
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Players = game:GetService("Players")

-- Tabla de frutas disponibles
local DevilFruits = {
    ["Gomu Gomu"] = {
        Price = 100000,
        Ability = "Rubber Body",
        Damage = 25,
        Moves = {"Pistol", "Rocket", "Gatling"}
    },
    ["Mera Mera"] = {
        Price = 2500000,
        Ability = "Fire Control",
        Damage = 45,
        Moves = {"Fire Fist", "Flame Emperor", "Dai Enkai"}
    },
    ["Gura Gura"] = {
        Price = 5000000,
        Ability = "Tremor",
        Damage = 60,
        Moves = {"Tremor Punch", "Tsunami", "Island Splitter"}
    }
}

-- Módulo para manejar frutas
local FruitSystem = {}

function FruitSystem:EquipFruit(player, fruitName)
    local fruitData = DevilFruits[fruitName]
    if not fruitData then return false end
    
    -- Guardar en datos del jugador
    local leaderstats = player:FindFirstChild("leaderstats")
    if leaderstats then
        local fruitStat = leaderstats:FindFirstChild("DevilFruit")
        if fruitStat then
            fruitStat.Value = fruitName
        end
    end
    
    -- Otorgar habilidades
    self:GrantAbilities(player, fruitData)
    return true
end

function FruitSystem:GrantAbilities(player, fruitData)
    -- Crear carpeta para habilidades
    local abilitiesFolder = player:FindFirstChild("Abilities")
    if not abilitiesFolder then
        abilitiesFolder = Instance.new("Folder")
        abilitiesFolder.Name = "Abilities"
        abilitiesFolder.Parent = player
    end
    
    -- Limpiar habilidades anteriores
    abilitiesFolder:ClearAllChildren()
    
    -- Agregar movimientos
    for _, moveName in ipairs(fruitData.Moves) do
        local ability = Instance.new("StringValue")
        ability.Name = moveName
        ability.Value = fruitData.Ability
        ability.Parent = abilitiesFolder
    end
end

return FruitSystem
